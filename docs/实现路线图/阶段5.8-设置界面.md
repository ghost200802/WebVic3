# 阶段5.8：设置界面

## 目标

实现游戏设置界面，提供游戏配置和存档管理功能。

**重要提示：**
- 本文档只包含接口定义和功能要求，不包含详细代码实现
- 完成后必须进行单元测试
- 测试覆盖率 > 80% 才能进入下一阶段

---

## 任务清单

- [ ] 实现设置视图组件
- [ ] 实现游戏设置组件
- [ ] 实现界面设置组件
- [ ] 实现存档管理组件
- [ ] 编写单元测试

---

## 接口定义要求

### SettingsProps接口

```
interface SettingsProps {
  settings: GameSettings
  onSave: (settings: GameSettings) => void
  onLoad: () => void
}
```

### GameSettings接口

```
interface GameSettings {
  autoSaveInterval: number
  autoSaveCount: number
  difficulty: 'easy' | 'normal' | 'hard'
  gameSpeed: number
  notifications: boolean
  soundEnabled: boolean
  theme: 'light' | 'dark'
  language: string
}
```

### SaveGame接口

```
interface SaveGame {
  id: string
  name: string
  date: Date
  gameDate: GameDate
  era: Era
  thumbnail?: string
}
```

### SaveManagerProps接口

```
interface SaveManagerProps {
  saves: SaveGame[]
  onLoad: (saveId: string) => void
  onSave: (name: string) => void
  onDelete: (saveId: string) => void
  onExport: (saveId: string) => void
  onImport: (data: string) => void
}
```

---

## 功能要求

### 游戏设置

- 游戏难度选择（简单、普通、困难）
- 游戏速度调节
- 自动保存间隔设置
- 自动保存数量限制
- 暂停/继续游戏

### 界面设置

- 主题选择（亮色/暗色）
- 语言选择
- 通知开关设置
- 音效开关设置
- 界面缩放

### 存档管理

- 显示存档列表
- 显示存档信息（名称、日期、游戏日期、时代）
- 加载存档
- 保存新存档
- 删除存档
- 导出存档到文件
- 从文件导入存档
- 显示存档缩略图
- 按时间排序存档

### 存档槽位

- 显示自动存档槽位
- 显示手动存档槽位
- 支持快速存档
- 支持快速读档

---

## 测试要求

### 设置界面测试

- [ ] 测试设置保存
- [ ] 测试设置加载
- [ ] 测试存档管理
- [ ] 测试主题切换
- [ ] 测试语言切换
- [ ] 测试难度选择
- [ ] 测试存档导入导出
- [ ] 测试自动存档

### 测试覆盖率要求

- 代码覆盖率 > 80%
- 所有公共组件必须有测试

---

## 实现文件

在 apps/web/src/components/settings/ 目录下创建以下文件：
- SettingsView.vue - 设置视图主组件
- GameSettings.vue - 游戏设置组件
- UISettings.vue - 界面设置组件
- SaveManager.vue - 存档管理组件
- SaveSlot.vue - 存档槽位组件
- index.ts - 导出文件

---

## 测试文件

创建以下测试文件：
- apps/web/src/components/settings/__tests__/SettingsView.test.ts
- apps/web/src/components/settings/__tests__/GameSettings.test.ts
- apps/web/src/components/settings/__tests__/UISettings.test.ts
- apps/web/src/components/settings/__tests__/SaveManager.test.ts
- apps/web/src/components/settings/__tests__/SaveSlot.test.ts

---

## 测试运行

运行单元测试命令：cd apps/web && pnpm test

运行覆盖率测试：cd apps/web && pnpm test:coverage

---

## 完成标准

### 功能实现完成

- [ ] 设置视图组件实现完整
- [ ] 游戏设置组件实现完整
- [ ] 界面设置组件实现完整
- [ ] 存档管理组件实现完整

### 文件创建完成

- [ ] SettingsView.vue 创建完成
- [ ] GameSettings.vue 创建完成
- [ ] UISettings.vue 创建完成
- [ ] SaveManager.vue 创建完成
- [ ] SaveSlot.vue 创建完成
- [ ] index.ts 创建完成

### 测试完成

- [ ] 所有单元测试通过
- [ ] 测试覆盖率 > 80%
- [ ] 所有公共组件有测试

### 代码检查完成

- [ ] pnpm typecheck 通过
- [ ] pnpm lint 通过
- [ ] 无TypeScript错误
- [ ] 无ESLint错误

---

## 进入下一阶段条件

✅ 所有任务清单完成
✅ 所有组件实现完整
✅ 所有单元测试通过
✅ 测试覆盖率 > 80%
✅ TypeScript类型检查通过
✅ ESLint代码检查通过

---

## 下一步

完成阶段5.8后，继续执行阶段5.9-数据可视化

**重要提醒：** 确保所有测试通过且覆盖率达标后再进入下一阶段！
