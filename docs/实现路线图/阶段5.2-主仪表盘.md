# 阶段5.2：主仪表盘

## 目标

实现游戏主仪表盘，展示游戏概览和关键指标。

**重要提示：**
- 本文档只包含接口定义和功能要求，不包含详细代码实现
- 完成后必须进行单元测试
- 测试覆盖率 > 80% 才能进入下一阶段

---

## 任务清单

- [ ] 实现仪表盘组件
- [ ] 实现统计卡片组件
- [ ] 实现警告通知组件
- [ ] 编写单元测试

---

## 接口定义要求

### DashboardData接口

```
interface DashboardData {
  gameDate: GameDate
  era: Era
  population: number
  treasury: number
  income: number
  expenses: number
  production: Map<string, number>
  alerts: GameAlert[]
}
```

### GameAlert接口

```
interface GameAlert {
  id: string
  type: 'info' | 'warning' | 'error' | 'success'
  title: string
  message: string
  timestamp: number
}
```

### DashboardProps接口

```
interface DashboardProps {
  data: DashboardData
  onAlertDismiss: (alertId: string) => void
}
```

### StatCardProps接口

```
interface StatCardProps {
  title: string
  value: string | number
  icon: string
  trend?: number
  unit?: string
}
```

---

## 功能要求

### 仪表盘功能

- 显示游戏概览信息
- 显示关键指标（人口、资金、收入/支出）
- 显示生产概况
- 显示市场概况
- 显示活跃事件
- 显示警告和通知

### 统计卡片

- 人口卡片：显示总人口数量
- 资金卡片：显示资金余额
- 时代卡片：显示当前时代
- 时间卡片：显示游戏日期
- 生产卡片：显示总产出
- 科技卡片：显示研发进度

### 警告通知

- 显示游戏内警告
- 显示错误信息
- 显示成功提示
- 显示通知消息
- 支持关闭通知
- 按时间排序显示

---

## 测试要求

### 仪表盘测试

- [ ] 测试数据绑定
- [ ] 测试统计卡片更新
- [ ] 测试警告显示
- [ ] 测试时间更新
- [ ] 测试通知关闭
- [ ] 测试趋势显示

### 测试覆盖率要求

- 代码覆盖率 > 80%
- 所有公共组件必须有测试

---

## 实现文件

在 apps/web/src/components/dashboard/ 目录下创建以下文件：
- Dashboard.vue - 仪表盘主组件
- StatCard.vue - 统计卡片组件
- AlertList.vue - 警告列表组件
- index.ts - 导出文件

---

## 测试文件

创建以下测试文件：
- apps/web/src/components/dashboard/__tests__/Dashboard.test.ts
- apps/web/src/components/dashboard/__tests__/StatCard.test.ts
- apps/web/src/components/dashboard/__tests__/AlertList.test.ts

---

## 测试运行

运行单元测试命令：cd apps/web && pnpm test

运行覆盖率测试：cd apps/web && pnpm test:coverage

---

## 完成标准

### 功能实现完成

- [ ] 仪表盘组件实现完整
- [ ] 统计卡片组件实现完整
- [ ] 警告通知组件实现完整

### 文件创建完成

- [ ] Dashboard.vue 创建完成
- [ ] StatCard.vue 创建完成
- [ ] AlertList.vue 创建完成
- [ ] index.ts 创建完成

### 测试完成

- [ ] 所有单元测试通过
- [ ] 测试覆盖率 > 80%
- [ ] 所有公共组件有测试

### 代码检查完成

- [ ] pnpm typecheck 通过
- [ ] pnpm lint 通过
- [ ] 无TypeScript错误
- [ ] 无ESLint错误

---

## 进入下一阶段条件

✅ 所有任务清单完成
✅ 所有组件实现完整
✅ 所有单元测试通过
✅ 测试覆盖率 > 80%
✅ TypeScript类型检查通过
✅ ESLint代码检查通过

---

## 下一步

完成阶段5.2后，继续执行阶段5.3-地图界面

**重要提醒：** 确保所有测试通过且覆盖率达标后再进入下一阶段！
