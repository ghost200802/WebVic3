# 阶段5.7：科技界面

## 目标

实现科技树界面，展示科技研发和解锁功能。

**重要提示：**
- 本文档只包含接口定义和功能要求，不包含详细代码实现
- 完成后必须进行单元测试
- 测试覆盖率 > 80% 才能进入下一阶段

---

## 任务清单

- [ ] 实现科技视图组件
- [ ] 实现科技树组件
- [ ] 实现研发队列组件
- [ ] 实现科技详情面板组件
- [ ] 编写单元测试

---

## 接口定义要求

### TechnologyViewProps接口

```
interface TechnologyViewProps {
  availableTechs: Technology[]
  researchedTechs: Set<string>
  researchQueue: ResearchQueue
  onAddToQueue: (techId: string) => void
  onRemoveFromQueue: (techId: string) => void
}
```

### TechTreeProps接口

```
interface TechTreeProps {
  technologies: Technology[]
  researchedTechs: Set<string>
  selectedTechId: string | null
  onSelect: (techId: string) => void
}
```

### ResearchQueueProps接口

```
interface ResearchQueueProps {
  queue: ResearchQueue
  researchedTechs: Set<string>
  onRemove: (techId: string) => void
  onReorder: (techIds: string[]) => void
}
```

### TechDetailProps接口

```
interface TechDetailProps {
  technology: Technology
  isResearched: boolean
  canResearch: boolean
  onAddToQueue: () => void
}
```

---

## 功能要求

### 科技树显示

- 显示所有科技节点
- 显示科技关系（前置科技连接线）
- 显示解锁效果
- 按时代筛选科技
- 支持搜索科技
- 高亮可研究科技
- 灰显未解锁科技
- 显示已完成科技

### 研发队列面板

- 显示队列中的科技
- 显示研发进度条
- 显示预计完成时间
- 调整队列顺序（拖拽）
- 移除科技
- 显示当前研发科技
- 显示科技成本

### 科技详情面板

- 显示科技基本信息（名称、描述）
- 显示前置科技列表
- 显示解锁内容（建筑、生产方式、商品）
- 显示研发成本
- 显示预计研发时间
- 显示科技时代
- 显示科技图标
- 支持添加到研发队列
- 显示研究状态

### 科技筛选功能

- 按时代筛选
- 按类型筛选
- 按状态筛选（可研究、已完成、未解锁）
- 搜索框实时筛选

---

## 测试要求

### 科技界面测试

- [ ] 测试科技树渲染
- [ ] 测试研发队列
- [ ] 测试科技详情显示
- [ ] 测试队列操作（添加、移除、重排序）
- [ ] 测试科技筛选
- [ ] 测试搜索功能
- [ ] 测试前置科技验证

### 测试覆盖率要求

- 代码覆盖率 > 80%
- 所有公共组件必须有测试

---

## 实现文件

在 apps/web/src/components/technology/ 目录下创建以下文件：
- TechnologyView.vue - 科技视图主组件
- TechTree.vue - 科技树组件
- ResearchQueue.vue - 研发队列组件
- TechDetail.vue - 科技详情面板组件
- TechNode.vue - 科技节点组件
- index.ts - 导出文件

---

## 测试文件

创建以下测试文件：
- apps/web/src/components/technology/__tests__/TechnologyView.test.ts
- apps/web/src/components/technology/__tests__/TechTree.test.ts
- apps/web/src/components/technology/__tests__/ResearchQueue.test.ts
- apps/web/src/components/technology/__tests__/TechDetail.test.ts
- apps/web/src/components/technology/__tests__/TechNode.test.ts

---

## 测试运行

运行单元测试命令：cd apps/web && pnpm test

运行覆盖率测试：cd apps/web && pnpm test:coverage

---

## 完成标准

### 功能实现完成

- [ ] 科技视图组件实现完整
- [ ] 科技树组件实现完整
- [ ] 研发队列组件实现完整
- [ ] 科技详情面板实现完整

### 文件创建完成

- [ ] TechnologyView.vue 创建完成
- [ ] TechTree.vue 创建完成
- [ ] ResearchQueue.vue 创建完成
- [ ] TechDetail.vue 创建完成
- [ ] TechNode.vue 创建完成
- [ ] index.ts 创建完成

### 测试完成

- [ ] 所有单元测试通过
- [ ] 测试覆盖率 > 80%
- [ ] 所有公共组件有测试

### 代码检查完成

- [ ] pnpm typecheck 通过
- [ ] pnpm lint 通过
- [ ] 无TypeScript错误
- [ ] 无ESLint错误

---

## 进入下一阶段条件

✅ 所有任务清单完成
✅ 所有组件实现完整
✅ 所有单元测试通过
✅ 测试覆盖率 > 80%
✅ TypeScript类型检查通过
✅ ESLint代码检查通过

---

## 下一步

完成阶段5.7后，继续执行阶段5.8-设置界面

**重要提醒：** 确保所有测试通过且覆盖率达标后再进入下一阶段！
