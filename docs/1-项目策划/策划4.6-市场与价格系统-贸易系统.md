# 市场与价格系统 - 贸易系统

## 概述

贸易系统管理国内和国际商品交易，包括内部贸易、外部贸易、贸易路线和贸易协定等。贸易是资源配置和经济发展的重要手段。

---

## 内部贸易

### 贸易类型

#### 区域间贸易

不同区域之间的商品交换。

```
贸易收益 = (目的地价格 - 出发地价格 - 运输成本) × 贸易量
```

| 区域类型 | 价格差异 | 贸易量 | 贸易收益 |
|----------|----------|--------|----------|
| 核心-发达 | 5% | 高 | 中等 |
| 核心-发展 | 10% | 中 | 高 |
| 核心-边远 | 20% | 低 | 中等 |
| 发达-发展 | 8% | 中 | 中等 |
| 发达-边远 | 15% | 低 | 低 |
| 发展-边远 | 12% | 中 | 低 |

#### 城乡贸易

城市和农村之间的商品交换。

```
城乡贸易收益 = (城市价格 - 农村价格 - 运输成本) × 贸易量
```

| 商品类型 | 城乡价差 | 贸易量 | 收益率 |
|----------|----------|--------|--------|
| 粮食 | 15% | 高 | 中 |
| 原料 | 20% | 中 | 高 |
| 手工品 | 25% | 低 | 中 |
| 工业品 | 30% | 低 | 中 |

### 贸易成本

#### 运输成本

```
运输成本 = 单位成本 × 距离 × 贸易量 × 运输系数
```

| 运输方式 | 单位成本 | 速度 | 适用距离 |
|----------|----------|------|----------|
| 畜力运输 | 0.5 | 慢 | <100km |
| 水路运输 | 0.3 | 中 | <500km |
| 铁路运输 | 0.2 | 快 | >100km |
| 公路运输 | 0.4 | 中快 | <200km |

#### 交易成本

```
交易成本 = 贸易金额 × 交易税率 × 交易系数
```

| 交易类型 | 交易税率 | 交易系数 |
|----------|----------|----------|
| 直接交易 | 2% | 1.0 |
| 批发交易 | 1% | 0.8 |
| 零售交易 | 3% | 1.2 |

#### 仓储成本

```
仓储成本 = 单位成本 × 存储量 × 存储天数 × 仓储系数
```

| 仓储类型 | 仓储系数 | 容量 |
|----------|----------|------|
| 简易仓储 | 0.05 | 低 |
| 标准仓储 | 0.03 | 中 |
| 冷藏仓储 | 0.10 | 低 |
| 自动化仓储 | 0.02 | 高 |

---

## 外部贸易

### 贸易伙伴

#### 伙伴类型

| 伙伴类型 | 贸易关系 | 贸易量 | 优惠 |
|----------|----------|--------|------|
| 敌对 | 0 | 0 | 无 |
| 冷战 | 0.3 | 低 | 无 |
| 中立 | 0.6 | 中 | 无 |
| 友好 | 0.9 | 高 | 10% |
| 同盟 | 1.2 | 很高 | 30% |

#### 贸易潜力

```
贸易潜力 = 经济规模 × 贸易开放度 × 距离衰减
```

| 经济规模 | 开放度 | 距离衰减 | 贸易潜力 |
|----------|--------|----------|----------|
| 大 | 高 | 0.8 | 很高 |
| 大 | 中 | 0.6 | 高 |
| 中 | 高 | 0.7 | 中高 |
| 中 | 中 | 0.5 | 中 |
| 小 | 高 | 0.6 | 中 |
| 小 | 中 | 0.4 | 低 |

### 贸易协定

#### 协定类型

| 协定类型 | 关税优惠 | 其他优惠 | 持续时间 |
|----------|----------|----------|----------|
| 无协定 | 0% | 无 | 无 |
| 普通协定 | 10% | 简化流程 | 365天 |
| 自由贸易 | 30% | 快速通道 | 730天 |
| 经济联盟 | 50% | 无需关税 | 1095天 |

#### 协定效果

```
协定收益 = (关税节省 + 流程优化 + 时间节省) × 贸易量
```

| 协定类型 | 关税节省 | 流程优化 | 时间节省 |
|----------|----------|----------|----------|
| 普通协定 | 10% | 5% | 10% |
| 自由贸易 | 30% | 15% | 30% |
| 经济联盟 | 50% | 25% | 50% |

---

## 贸易路线

### 路线规划

#### 路线要素

```
路线收益 = (价差 - 成本) × 贸易量 × 路线系数
```

| 路线要素 | 影响因素 | 权重 |
|----------|----------|------|
| 价格差 | 市场差异 | 0.4 |
| 运输成本 | 距离、方式 | 0.3 |
| 贸易量 | 市场规模 | 0.2 |
| 贸易关系 | 外交关系 | 0.1 |

#### 路线类型

| 路线类型 | 贸易伙伴 | 商品类型 | 收益率 |
|----------|----------|----------|--------|
| 原料路线 | 资源丰富国 | 原料 | 高 |
| 工业路线 | 工业发达国 | 工业品 | 中高 |
| 奢侈品路线 | 富裕国家 | 奢侈品 | 高 |
| 粮食路线 | 农业国 | 粮食 | 中 |

### 路线优化

#### 优化目标

```
优化目标 = 收益最大化 - 成本最小化 - 风险最小化
```

#### 优化策略

| 策略 | 收益 | 成本 | 风险 | 适用场景 |
|------|------|------|------|----------|
| 利润优先 | 最高 | 中 | 高 | 短期贸易 |
| 成本优先 | 中 | 最低 | 低 | 长期贸易 |
| 风险优先 | 低 | 中 | 最低 | 稳定贸易 |
| 平衡策略 | 中高 | 中 | 中 | 综合贸易 |

---

## 贸易平衡

### 贸易顺差

```
贸易顺差 = 出口额 - 进口额
```

| 顺差规模 | 影响 | 持续时间 |
|----------|------|----------|
| 小规模 | 货币小幅升值 | 可持续 |
| 中规模 | 货币明显升值 | 需关注 |
| 大规模 | 货币大幅升值 | 需调整 |
| 超大规模 | 严重贸易摩擦 | 危险 |

### 贸易逆差

```
贸易逆差 = 进口额 - 出口额
```

| 逆差规模 | 影响 | 持续时间 |
|----------|------|----------|
| 小规模 | 外汇小幅流失 | 可接受 |
| 中规模 | 外汇明显流失 | 需关注 |
| 大规模 | 外汇大幅流失 | 需调整 |
| 超大规模 | 外汇危机 | 危险 |

### 平衡调整

#### 自动调整

```
调整速度 = 市场弹性 × 调整系数
```

| 市场弹性 | 调整速度 | 调整周期 |
|----------|----------|----------|
| 高弹性 | 快 | 30天 |
| 中弹性 | 中 | 60天 |
| 低弹性 | 慢 | 90天 |

#### 政策调整

```
政策效果 = 政策强度 × 政策持续时间
```

| 政策类型 | 政策强度 | 效果时间 |
|----------|----------|----------|
| 关税调整 | 中 | 立即 |
| 汇率调整 | 高 | 7天 |
| 贸易协定 | 低 | 30天 |

---

## 贸易壁垒

### 关税壁垒

```
关税成本 = 贸易金额 × 关税税率
```

| 关税类型 | 关税税率 | 影响商品 |
|----------|----------|----------|
| 普通关税 | 10% | 所有商品 |
| 高关税 | 25% | 特定商品 |
| 禁止关税 | 100% | 禁止贸易 |

### 非关税壁垒

#### 配额制度

```
配额限制 = 配额数量 × 配额系数
```

| 配额类型 | 配额系数 | 影响程度 |
|----------|----------|----------|
| 宽松配额 | 0.8 | 轻微影响 |
| 严格配额 | 0.5 | 中等影响 |
| 紧张配额 | 0.2 | 严重影响 |

#### 技术壁垒

```
技术壁垒 = 技术标准 × 认证成本
```

| 技术标准 | 认证成本 | 影响程度 |
|----------|----------|----------|
| 低标准 | 低 | 轻微影响 |
| 中标准 | 中 | 中等影响 |
| 高标准 | 高 | 严重影响 |

---

## 贸易数据

### 贸易统计

| 贸易类型 | 占比 | 年增长率 | 利润率 |
|----------|------|----------|--------|
| 内部贸易 | 60% | 5% | 8-12% |
| 外部贸易 | 40% | 10% | 15-25% |

### 商品贸易数据

| 商品类型 | 贸易量 | 价格差 | 运输成本 | 净收益 |
|----------|--------|--------|----------|--------|
| 粮食 | 高 | 15% | 8% | 7% |
| 原料 | 中 | 20% | 10% | 10% |
| 工业品 | 中 | 25% | 12% | 13% |
| 奢侈品 | 低 | 35% | 15% | 20% |

---

## 贸易策略

### 早期策略

#### 策略重点

- 建立基础贸易网络
- 优先内部贸易
- 逐步发展外部贸易

#### 推荐策略

| 优先级 | 贸易类型 | 理由 |
|--------|----------|------|
| 最高 | 内部贸易 | 成本低，风险小 |
| 高 | 邻近贸易 | 距离近，关系好 |
| 中 | 资源贸易 | 互补性强 |
| 低 | 奢侈品贸易 | 需求有限 |

### 中期策略

#### 策略重点

- 扩大贸易网络
- 建立贸易协定
- 发展高价值贸易

#### 推荐策略

| 优先级 | 贸易类型 | 理由 |
|--------|----------|------|
| 最高 | 工业品贸易 | 利润高 |
| 高 | 贸易协定 | 长期稳定 |
| 中 | 原料贸易 | 确保供应 |
| 低 | 奢侈品贸易 | 市场有限 |

### 后期策略

#### 策略重点

- 优化贸易结构
- 建立贸易联盟
- 发展高端贸易

#### 推荐策略

| 优先级 | 贸易类型 | 理由 |
|--------|----------|------|
| 最高 | 高科技贸易 | 利润极高 |
| 高 | 贸易联盟 | 稳定供应 |
| 中 | 工业品贸易 | 稳定收入 |
| 低 | 原料贸易 | 利润较低 |

---

## 贸易风险

### 政治风险

| 风险类型 | 风险等级 | 影响 | 应对 |
|----------|----------|------|------|
| 关系恶化 | 高 | 贸易减少 | 多元化 |
| 贸易战 | 很高 | 关税增加 | 寻找替代 |
| 贸易禁运 | 极高 | 停止贸易 | 国内替代 |

### 经济风险

| 风险类型 | 风险等级 | 影响 | 应对 |
|----------|----------|------|------|
| 汇率波动 | 中 | 利润变化 | 对冲 |
| 价格波动 | 中 | 收益变化 | 多样化 |
| 市场变化 | 高 | 需求变化 | 灵活调整 |

---

## 贸易系统接口定义

### 贸易管理器接口

```typescript
interface ITradeManager {
  calculateTradeRoute(route: TradeRoute): TradeResult

  createTradeRoute(partner: string, goods: string): TradeRoute
  cancelTradeRoute(routeId: string): void

  getActiveRoutes(): TradeRoute[]
  getTradeHistory(): TradeRecord[]

  setTariff(partner: string, goods: string, rate: number): void

  negotiateAgreement(partner: string, agreementType: AgreementType): boolean
}

interface TradeRoute {
  id: string
  partner: string
  goods: string
  quantity: number
  frequency: number

  cost: number
  revenue: number
  profit: number

  status: 'active' | 'paused' | 'cancelled'
}
```

---

## 贸易系统性能优化

### 计算优化

1. **批量计算**：批量计算多条贸易路线
2. **缓存结果**：缓存贸易计算结果
3. **事件驱动**：只在变化时重新计算
4. **优先级队列**：高价值贸易优先处理

### 存储优化

1. **增量存储**：只存储贸易变化
2. **定期清理**：清理历史数据
3. **压缩存储**：压缩贸易记录
