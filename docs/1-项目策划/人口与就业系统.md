# 人口与就业系统策划文档

## 1. 系统概述

人口与就业系统负责管理游戏中的劳动力资源，包括人口增长、结构变化、就业分配、工资决定和生活水平计算。人口既是生产要素，也是消费主体，是连接生产与市场的核心环节。

---

## 2. 核心概念

### 2.1 人口群体（Population Group）

```typescript
interface PopulationGroup {
  id: string;
  
  // 基本信息
  size: number;           // 人口数量
  
  // 结构属性
  ageGroup: AgeGroup;     // 年龄段
  education: EducationLevel; // 教育水平
  socialClass: SocialClass;  // 社会阶层
  
  // 就业状态
  employment: EmploymentStatus;
  workplace?: BuildingId;    // 工作地点
  profession?: Profession;   // 职业
  
  // 经济属性
  wage: number;           // 当前工资
  wealth: number;         // 财富积累
  livingStandard: number; // 生活水平 0-100
  
  // 需求满足度
  needs: {
    survival: number;     // 生存需求满足度
    basic: number;        // 基础需求满足度
    improved: number;     // 改善需求满足度
    luxury: number;       // 奢侈需求满足度
  };
}
```

### 2.2 年龄结构

| 年龄段 | 比例范围 | 劳动力 | 特点 |
|--------|----------|--------|------|
| 儿童(0-14) | 20-40% | 否 | 消耗资源，成长 |
| 青壮年(15-64) | 50-70% | 是 | 主要劳动力 |
| 老年(65+) | 5-20% | 否 | 退休消耗 |

### 2.3 教育水平

| 等级 | 时代解锁 | 工人效率 | 培养时间 |
|------|----------|----------|----------|
| 文盲 | 石器 | 1.0x | - |
| 基础识字 | 铁器 | 1.2x | 2年 |
| 小学 | 中世纪 | 1.5x | 4年 |
| 中学 | 工业 | 2.0x | 6年 |
| 大学 | 电气 | 3.0x | 10年 |
| 研究生 | 信息 | 4.0x | 14年 |

### 2.4 社会阶层

| 阶层 | 比例 | 收入倍率 | 消费特点 |
|------|------|----------|----------|
| 贵族/精英 | 1-3% | 10x+ | 奢侈品为主 |
| 中产阶级 | 10-30% | 3-5x | 改善品+奢侈品 |
| 工人阶级 | 30-60% | 1-2x | 基础品+改善品 |
| 贫民阶层 | 20-50% | 0.5-1x | 生存品为主 |

---

## 3. 人口增长模型

### 3.1 增长率计算

```
人口增长率 = 基础出生率 - 死亡率 + 净迁移率

出生率 = 基础出生率 × 生活水平系数 × 卫生系数
死亡率 = 基础死亡率 × 医疗系数 × 营养系数
```

### 3.2 各时代人口参数

| 时代 | 年出生率 | 年死亡率 | 预期寿命 | 净增长率 |
|------|----------|----------|----------|----------|
| 石器 | 4.0% | 3.5% | 25年 | +0.5% |
| 青铜 | 3.5% | 2.8% | 30年 | +0.7% |
| 铁器 | 3.2% | 2.5% | 35年 | +0.7% |
| 中世纪 | 3.0% | 2.2% | 40年 | +0.8% |
| 工业革命 | 2.8% | 1.8% | 50年 | +1.0% |
| 电气 | 2.2% | 1.2% | 65年 | +1.0% |
| 信息 | 1.5% | 0.8% | 75年 | +0.7% |
| AI | 1.2% | 0.6% | 85年 | +0.6% |

### 3.3 生活水平对增长影响

```
生活水平系数:
- 0-20:  0.7x (困难生存)
- 20-40: 0.9x (勉强维持)
- 40-60: 1.0x (正常水平)
- 60-80: 1.1x (良好生活)
- 80-100: 1.2x (富裕生活)
```

---

## 4. 就业系统

### 4.1 就业流程

```
1. 建筑发布职位空缺
2. 求职者根据条件匹配
3. 工资协商（基于市场工资）
4. 确认就业
```

### 4.2 工资决定机制

```typescript
// 市场均衡工资
function calculateEquilibriumWage(profession: Profession): number {
  const laborSupply = getTotalLaborSupply(profession);
  const laborDemand = getTotalLaborDemand(profession);
  
  const baseWage = profession.baseWage;
  const ratio = laborDemand / laborSupply;
  
  // 供不应求时工资上涨
  return baseWage * Math.pow(ratio, 0.3);
}

// 实际工资 = 均衡工资 × 建筑盈利系数 × 技能系数
function calculateActualWage(
  equilibriumWage: number,
  buildingProfitability: number,
  skillLevel: number
): number {
  return equilibriumWage * buildingProfitability * (1 + skillLevel * 0.1);
}
```

### 4.3 职业分类

| 职业类别 | 工作场所 | 基础工资 | 教育要求 |
|----------|----------|----------|----------|
| 农民 | 农田/牧场 | 10 | 文盲 |
| 矿工 | 矿场 | 12 | 文盲 |
| 工匠 | 作坊 | 15 | 基础识字 |
| 技工 | 工厂 | 20 | 小学 |
| 工程师 | 现代工厂 | 40 | 中学 |
| 研究员 | 实验室 | 60 | 大学 |
| 管理者 | 各类建筑 | 50 | 中学+ |
| 程序员 | 软件公司 | 80 | 大学 |

### 4.4 失业系统

```typescript
interface UnemploymentSystem {
  // 失业率计算
  unemploymentRate: number; // = 失业人口 / 总劳动力
  
  // 失业影响
  effects: {
    socialUnrest: number;    // 社会动荡
    wagePressure: number;    // 工资压力（失业率高工资下降）
    emigration: number;      // 人口外迁
  };
  
  // 失业救济
  unemploymentBenefit: {
    enabled: boolean;
    rate: number;  // 为原工资的百分比
    duration: number; // 领取时长
  };
}
```

---

## 5. 生活水平计算

### 5.1 生活水平公式

```
生活水平 = 基础分 + 需求满足分 + 环境分 + 就业分

基础分 = 20
需求满足分 = 生存需求×0.3 + 基础需求×0.3 + 改善需求×0.2 + 奢侈需求×0.2
环境分 = 卫生条件×0.5 + 安全程度×0.3 + 文化娱乐×0.2
就业分 = (就业? +15 : 0) + (工资满意度×10)
```

### 5.2 需求满足计算

```typescript
function calculateNeedsFulfillment(
  pop: PopulationGroup,
  market: Market
): NeedsFulfillment {
  const income = pop.wage + pop.wealth * 0.01; // 月收入
  
  // 按优先级消费
  let remainingIncome = income;
  const fulfillment = {
    survival: 0,
    basic: 0,
    improved: 0,
    luxury: 0
  };
  
  // 1. 生存需求（必需满足）
  const survivalCost = calculateSurvivalCost(pop, market);
  if (remainingIncome >= survivalCost) {
    fulfillment.survival = 100;
    remainingIncome -= survivalCost;
  } else {
    fulfillment.survival = (remainingIncome / survivalCost) * 100;
    return fulfillment; // 无法满足生存需求，停止消费
  }
  
  // 2. 基础需求
  const basicCost = calculateBasicCost(pop, market);
  fulfillment.basic = Math.min(100, (remainingIncome / basicCost) * 100);
  remainingIncome -= Math.min(basicCost, remainingIncome);
  
  // 3. 改善需求
  const improvedCost = calculateImprovedCost(pop, market);
  fulfillment.improved = Math.min(100, (remainingIncome / improvedCost) * 100);
  remainingIncome -= Math.min(improvedCost, remainingIncome);
  
  // 4. 奢侈需求
  const luxuryCost = calculateLuxuryCost(pop, market);
  fulfillment.luxury = Math.min(100, (remainingIncome / luxuryCost) * 100);
  
  return fulfillment;
}
```

### 5.3 生活水平影响

| 生活水平 | 效果 |
|----------|------|
| 0-20 | 饥荒风险，死亡+50%，暴动风险 |
| 20-40 | 贫困，效率-20%，迁出倾向 |
| 40-60 | 正常，无特殊效果 |
| 60-80 | 良好，效率+10%，迁入倾向 |
| 80-100 | 富裕，效率+20%，消费升级 |

---

## 6. 人口流动

### 6.1 内部迁移

```
迁移动机 = (目标地生活水平 - 当前生活水平) × 0.5
       + (目标地工资 - 当前工资) × 0.3
       + (目标地就业机会) × 0.2

迁移量 = 总人口 × 迁移动机 × 流动性系数
```

### 6.2 社会阶层流动

```typescript
interface SocialMobility {
  // 向上流动条件
  upwardConditions: {
    minLivingStandard: 70;
    minEducation: EducationLevel;
    minWealth: number;
    duration: number; // 维持条件的时间
  };
  
  // 向下流动触发
  downwardTriggers: {
    livingStandard: 20;
    unemploymentDuration: 30; // 连续失业天数
  };
  
  // 流动概率
  mobilityRate: number; // 每周期流动概率
}
```

---

## 7. 人口需求

### 7.1 各阶层需求结构

#### 贫民阶层
```yaml
生存需求:
  - 谷物: 2 单位/人/年
  - 简易住所: 1 单位/人

基础需求:
  - 简单衣物: 1 单位/人/年

改善需求: 无

奢侈需求: 无
```

#### 工人阶级
```yaml
生存需求:
  - 面包: 1.5 单位/人/年
  - 肉类: 0.5 单位/人/年

基础需求:
  - 普通衣物: 2 单位/人/年
  - 简单家具: 0.5 单位/人/年

改善需求:
  - 更好食物: 1 单位/人/年
  - 娱乐: 0.2 单位/人/年

奢侈需求: 无
```

#### 中产阶级
```yaml
生存需求:
  - 多样化食物: 2 单位/人/年
  - 良好住所: 1 单位/人

基础需求:
  - 优质衣物: 3 单位/人/年
  - 家具: 1 单位/人/年

改善需求:
  - 精致食物: 1.5 单位/人/年
  - 娱乐: 0.5 单位/人/年
  - 教育服务: 0.3 单位/人/年

奢侈需求:
  - 奢侈品: 0.2 单位/人/年
```

#### 精英阶层
```yaml
生存需求:
  - 高级食物: 3 单位/人/年
  - 豪华住所: 1 单位/人

基础需求:
  - 高级衣物: 5 单位/人/年
  - 高档家具: 2 单位/人/年

改善需求:
  - 精致食物: 2 单位/人/年
  - 娱乐: 1 单位/人/年
  - 教育服务: 1 单位/人/年

奢侈需求:
  - 珠宝: 0.5 单位/人/年
  - 艺术品: 0.3 单位/人/年
  - 奢侈服务: 0.5 单位/人/年
```

---

## 8. 劳动力分配

### 8.1 自动分配逻辑

```typescript
function autoAllocateLabor(): void {
  // 1. 计算各部门劳动力需求
  const demands = calculateLaborDemands();
  
  // 2. 按优先级分配
  const priority = [
    'food',      // 食品生产优先
    'raw_material', // 原料次之
    'manufacturing', // 制造业
    'service',   // 服务业
    'luxury'     // 奢侈品最后
  ];
  
  let availableLabor = getTotalAvailableLabor();
  
  for (const sector of priority) {
    const allocation = Math.min(
      demands[sector],
      availableLabor * allocationRatio[sector]
    );
    allocateTo(sector, allocation);
    availableLabor -= allocation;
  }
}
```

### 8.2 玩家干预

玩家可以：
1. 设置优先发展行业
2. 限制特定行业招聘
3. 强制迁移劳动力
4. 设置最低/最高工资

---

## 9. UI设计

### 9.1 人口总览面板

```
┌─────────────────────────────────────────────────────────────┐
│ 👥 人口总览                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 总人口: 125,430 (+1.2% 年增长)                              │
│                                                             │
│ ─── 年龄结构 ──────────────────────────────────────────     │
│ 儿童 (28%)    ██████████████░░░░░░░░░░░░  35,120          │
│ 青壮年 (65%)  ██████████████████████████░░ 81,530         │
│ 老年 (7%)     ███░░░░░░░░░░░░░░░░░░░░░░░░  8,780          │
│                                                             │
│ ─── 社会阶层 ──────────────────────────────────────────     │
│ 精英 (2%)     ██░░░░░░░░░░░░░░░░░░░░░░░░   2,508          │
│ 中产 (25%)    ████████████░░░░░░░░░░░░░░░  31,357         │
│ 工人 (50%)    ██████████████████████░░░░░  62,715         │
│ 贫民 (23%)    ███████████░░░░░░░░░░░░░░░░  28,850         │
│                                                             │
│ ─── 就业状况 ──────────────────────────────────────────     │
│ 就业: 72,340 (88.7%)  ████████████████████░░               │
│ 失业: 9,190 (11.3%)   ██░░░░░░░░░░░░░░░░░░░               │
│                                                             │
│ 平均生活水平: 52/100  [详情]                                │
│ 平均工资: ¥15.2/天                                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 9.2 就业管理面板

```
┌─────────────────────────────────────────────────────────────┐
│ 💼 就业管理                                     [自动分配]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 劳动力总计: 81,530 | 在岗: 72,340 | 失业: 9,190            │
│                                                             │
│ ─── 行业就业分布 ──────────────────────────────────────     │
│                                                             │
│ 行业        就业人数   空缺职位   平均工资   满意度         │
│ ────────────────────────────────────────────────────────   │
│ 农业        25,000     2,000      ¥10.2      75%  [调整]   │
│ 采矿        8,500      500        ¥12.5      68%  [调整]   │
│ 制造业      22,000     3,500      ¥18.0      82%  [调整]   │
│ 服务业      12,000     1,200      ¥22.5      88%  [调整]   │
│ 建筑        4,840      800        ¥15.0      71%  [调整]   │
│                                                             │
│ ─── 失业人口详情 ──────────────────────────────────────     │
│                                                             │
│ 失业原因分析:                                               │
│ • 技能不匹配: 4,500 (49%)                                   │
│ • 结构性失业: 3,200 (35%)                                   │
│ • 摩擦性失业: 1,490 (16%)                                   │
│                                                             │
│ [技能培训]  [公共就业]  [失业救济设置]                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 9.3 生活水平面板

```
┌─────────────────────────────────────────────────────────────┐
│ 🏠 生活水平详情                                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 整体生活水平: 52/100  (正常)                                │
│                                                             │
│ ─── 需求满足度 ────────────────────────────────────────     │
│                                                             │
│ 生存需求 ████████████████████░░░░░░░░░░░░  95%             │
│ 基础需求 ██████████████░░░░░░░░░░░░░░░░░░  70%             │
│ 改善需求 ████████░░░░░░░░░░░░░░░░░░░░░░░░  40%             │
│ 奢侈需求 ██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  10%             │
│                                                             │
│ ─── 各阶层生活水平 ────────────────────────────────────     │
│                                                             │
│ 精英阶层   ████████████████████████████░░  90  [详情]      │
│ 中产阶级   ██████████████████░░░░░░░░░░░░  65  [详情]      │
│ 工人阶级   ████████████░░░░░░░░░░░░░░░░░░  48  [详情]      │
│ 贫民阶层   ██████░░░░░░░░░░░░░░░░░░░░░░░░  28  [详情]      │
│                                                             │
│ ─── 改善建议 ────────────────────────────────────────       │
│ • 提高最低工资可改善工人阶级生活水平                        │
│ • 增加食品供给可提升整体需求满足度                          │
│ • 扩大教育投入可促进阶层流动                                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 10. 平衡参数

### 10.1 就业相关

| 参数 | 值 | 说明 |
|------|-----|------|
| 基础失业率 | 5% | 正常摩擦性失业 |
| 最大就业率 | 98% | 总有少量失业 |
| 工资调整速度 | 5%/周期 | 供需影响工资的速度 |

### 10.2 生活水平相关

| 参数 | 值 | 说明 |
|------|-----|------|
| 生活水平基准 | 50 | 正常水平 |
| 生存需求权重 | 0.4 | 最重要 |
| 基础需求权重 | 0.3 | 次重要 |
| 改善需求权重 | 0.2 | 一般 |
| 奢侈需求权重 | 0.1 | 最不重要 |
