# 市场与价格系统 - 定价机制

## 概述

定价机制是市场系统的核心，决定了商品的价格如何形成和调整。本文档详细描述定价的各种因素和计算方法。

---

## 基础定价

### 生产成本定价

```
基础价格 = (原料成本 + 加工成本 + 运输成本) × (1 + 利润率)
```

#### 原料成本

```
原料成本 = Σ(原料价格 × 原料消耗量)
```

#### 加工成本

```
加工成本 = 人工成本 + 设备成本 + 能源成本
```

##### 人工成本

```
人工成本 = 工人数量 × 平均工资 × 生产时间
```

##### 设备成本

```
设备成本 = 设备价值 × 折旧率 × 使用时间
```

##### 能源成本

```
能源成本 = 能源价格 × 能源消耗量
```

#### 运输成本

```
运输成本 = 运输距离 × 单位运输成本 × 运输量
```

#### 利润率

不同商品类型有不同利润率：

| 商品类型 | 基础利润率 | 风险加成 | 总利润率 |
|----------|------------|----------|----------|
| 原料 | 15% | 0% | 15% |
| 中间品 | 20% | 5% | 25% |
| 最终品 | 25% | 5% | 30% |
| 奢侈品 | 40% | 10% | 50% |
| 军用品 | 30% | 10% | 40% |

---

## 市场定价

### 供需定价

```
市场价格 = 基础价格 × 供需系数
```

#### 供需系数计算

```
供需系数 = (需求 / 供给)^弹性
```

当需求=供给时，供需系数=1。

##### 供需比例与系数

| 供需比例 | 供需系数 | 价格变化 |
|----------|----------|----------|
| 0.5 | 0.59 | -41% |
| 0.7 | 0.79 | -21% |
| 0.9 | 0.91 | -9% |
| 1.0 | 1.00 | 0% |
| 1.1 | 1.08 | +8% |
| 1.3 | 1.19 | +19% |
| 1.5 | 1.27 | +27% |
| 2.0 | 1.41 | +41% |

---

## 竞争定价

### 竞争因素

#### 竞争者数量

```
竞争系数 = 1 / (1 + 竞争者数量 × 竞争强度)
```

| 竞争者数量 | 竞争系数 | 价格影响 |
|------------|----------|----------|
| 0 | 1.00 | 无影响 |
| 1-3 | 0.80-0.95 | 小幅下降 |
| 4-6 | 0.60-0.80 | 中等下降 |
| 7-10 | 0.40-0.60 | 大幅下降 |
| >10 | <0.40 | 剧烈下降 |

#### 市场份额

```
份额系数 = 1 - (市场份额 × 份额影响)
```

| 市场份额 | 份额系数 | 说明 |
|----------|----------|------|
| <10% | 1.00 | 无影响 |
| 10-30% | 0.95 | 轻微影响 |
| 30-50% | 0.90 | 适度影响 |
| 50-70% | 0.85 | 较大影响 |
| >70% | 0.80 | 显著影响 |

---

## 时间定价

### 季节定价

```
季节系数 = 1 + 季节波动 × 季节权重
```

#### 季节波动

| 商品类型 | 春季系数 | 夏季系数 | 秋季系数 | 冬季系数 |
|----------|----------|----------|----------|----------|
| 粮食 | 1.05 | 0.95 | 0.90 | 1.10 |
| 肉类 | 1.00 | 0.95 | 1.05 | 1.00 |
| 服装 | 0.90 | 0.85 | 1.10 | 1.15 |
| 燃料 | 0.85 | 0.80 | 0.85 | 1.50 |

### 生命周期定价

```
生命周期系数 = 1 + (生命周期阶段 - 2) × 0.1
```

| 生命周期阶段 | 系数 | 说明 |
|--------------|------|------|
| 引入期 | 0.9 | 高定价或渗透定价 |
| 成长期 | 1.0 | 标准定价 |
| 成熟期 | 1.1 | 稳定定价 |
| 衰退期 | 1.2 | 清仓定价 |

---

## 地理定价

### 区域定价

```
区域系数 = 1 + 区域差异 × 区域权重
```

#### 区域差异

| 区域类型 | 区域系数 | 说明 |
|----------|----------|------|
| 核心区域 | 1.00 | 基准区域 |
| 发达区域 | 1.10 | 略高于基准 |
| 发展区域 | 0.90 | 略低于基准 |
| 边远区域 | 1.20 | 运输成本高 |
| 贫困区域 | 0.80 | 需求不足 |

### 距离定价

```
距离系数 = 1 + (距离 / 基准距离) × 距离权重
```

#### 距离权重

| 距离范围 | 距离权重 | 系数 |
|----------|----------|------|
| <100km | 0.05 | 1.05 |
| 100-300km | 0.10 | 1.10 |
| 300-500km | 0.15 | 1.15 |
| 500-1000km | 0.20 | 1.20 |
| >1000km | 0.25 | 1.25 |

---

## 政策定价

### 关税定价

```
关税后价格 = 市场价格 × (1 + 关税税率)
```

#### 关税税率

| 商品类型 | 普通关税 | 高关税 | 禁止贸易 |
|----------|----------|--------|----------|
| 原料 | 5% | 15% | 200% |
| 中间品 | 10% | 25% | 200% |
| 最终品 | 15% | 35% | 200% |
| 奢侈品 | 25% | 50% | 200% |
| 军用品 | 20% | 100% | 200% |

### 补贴定价

```
补贴后价格 = 市场价格 - 补贴金额
```

#### 补贴类型

| 补贴类型 | 补贴金额 | 适用对象 |
|----------|----------|----------|
| 生产补贴 | 10-20% | 生产者 |
| 消费补贴 | 5-10% | 消费者 |
| 出口补贴 | 15-25% | 出口商 |
| 进口补贴 | 10-20% | 进口商 |

### 税收定价

```
税收后价格 = 市场价格 × (1 + 税收税率)
```

#### 税收类型

| 税收类型 | 税收税率 | 适用对象 |
|----------|----------|----------|
| 消费税 | 5-15% | 消费者 |
| 增值税 | 10-20% | 交易双方 |
| 奢侈税 | 20-40% | 奢侈品 |
| 资源税 | 5-15% | 资源开采 |

---

## 心理定价

### 价格尾数

```
心理价格 = 基础价格 × 尾数系数
```

#### 尾数系数

| 尾数策略 | 系数 | 示例 |
|----------|------|------|
| 整数定价 | 1.00 | 100元 |
| 尾数定价 | 0.99 | 99元 |
| 幸运定价 | 0.88 | 88元 |

### 价格锚定

```
锚定价格 = 参考价格 × 锚定系数
```

#### 锚定系数

| 锚定类型 | 系数 | 说明 |
|----------|------|------|
| 高价锚定 | 0.85 | 原价高，现价低 |
| 低价锚定 | 1.15 | 原价低，现价高 |
| 平价锚定 | 1.00 | 标准定价 |

---

## 定价策略

### 渗透定价

策略：低价快速占领市场

```
渗透价格 = 基础价格 × 0.7
```

适用场景：
- 新产品引入
- 市场竞争激烈
- 需求弹性大

### 撇脂定价

策略：高价快速回收成本

```
撇脂价格 = 基础价格 × 1.5
```

适用场景：
- 创新产品
- 市场垄断
- 需求弹性小

### 竞争定价

策略：跟随竞争对手价格

```
竞争价格 = 竞争者价格 × 竞争系数
```

适用场景：
- 成熟市场
- 竞争激烈
- 产品同质化

### 价值定价

策略：根据客户感知价值定价

```
价值价格 = 感知价值 × 价值系数
```

适用场景：
- 高端产品
- 差异化产品
- 品牌产品

---

## 定价调整

### 自动调整

```
调整频率 = 基础频率 × 市场波动
```

| 市场波动 | 调整频率 | 说明 |
|----------|----------|------|
| 低波动 | 每周 | 价格稳定 |
| 中波动 | 每天 | 正常调整 |
| 高波动 | 实时 | 快速响应 |

### 手动调整

玩家可以手动调整价格：

```
手动价格 = 市场价格 × 手动系数
```

| 手动系数 | 价格调整 | 说明 |
|----------|----------|------|
| 0.8 | -20% | 降价促销 |
| 1.0 | 0% | 维持原价 |
| 1.2 | +20% | 涨价提利 |

---

## 定价数据示例

### 商品定价示例

| 商品 | 基础价格 | 供需系数 | 季节系数 | 市场价格 |
|------|----------|----------|----------|----------|
| 粮食 | 10 | 1.10 | 1.10 | 12.1 |
| 钢材 | 100 | 0.90 | 1.00 | 90.0 |
| 服装 | 50 | 1.20 | 1.15 | 69.0 |
| 奢侈品 | 500 | 1.30 | 1.00 | 650.0 |

### 定价策略对比

| 策略 | 价格 | 销量 | 利润 | 适用场景 |
|------|------|------|------|----------|
| 渗透定价 | 70 | 150 | 10500 | 新产品 |
| 标准定价 | 100 | 100 | 10000 | 正常产品 |
| 撇脂定价 | 150 | 50 | 7500 | 创新产品 |
| 价值定价 | 120 | 80 | 9600 | 高端产品 |

---

## 定价系统接口定义

### 定价管理器接口

```typescript
interface IPricingManager {
  calculateBasePrice(goodsId: string): number
  calculateMarketPrice(goodsId: string): number

  setPricingStrategy(goodsId: string, strategy: PricingStrategy): void

  adjustPrice(goodsId: string, factor: number): void

  getPriceHistory(goodsId: string): PriceRecord[]
}

interface PricingStrategy {
  type: 'penetration' | 'skimming' | 'competitive' | 'value'
  basePrice: number
  adjustment: number
}
```

---

## 定价系统性能优化

### 计算优化

1. **批量计算**：多个商品批量定价
2. **缓存结果**：缓存定价结果
3. **事件驱动**：只在变化时重新定价
4. **优先级队列**：重要商品优先定价

### 存储优化

1. **增量存储**：只存储价格变化
2. **定期清理**：清理历史数据
3. **压缩存储**：压缩价格记录
