# 市场与价格系统 - 价格波动

## 概述

价格波动是市场系统的核心特征，反映了各种因素对价格的影响。本文档详细描述价格波动的类型、机制和影响。

---

## 波动类型

### 自然波动

由自然因素引起的价格波动。

#### 季节波动

```
季节波动 = 基础价格 × 季节系数
```

| 商品 | 春季 | 夏季 | 秋季 | 冬季 |
|------|------|------|------|------|
| 粮食 | 1.05 | 0.95 | 0.90 | 1.10 |
| 肉类 | 1.00 | 0.95 | 1.05 | 1.00 |
| 服装 | 0.90 | 0.85 | 1.10 | 1.15 |
| 燃料 | 0.85 | 0.80 | 0.85 | 1.50 |
| 蔬菜 | 1.10 | 0.80 | 1.00 | 1.10 |

#### 气候波动

```
气候波动 = 基础价格 × (1 + 气候影响)
```

| 气候事件 | 影响程度 | 持续时间 |
|----------|----------|----------|
| 干旱 | +30% | 30-60天 |
| 洪水 | +40% | 30-60天 |
| 寒潮 | +25% | 15-30天 |
| 热浪 | +20% | 15-30天 |
| 风暴 | +15% | 5-15天 |

#### 资源枯竭

```
枯竭波动 = 基础价格 × (1 + 枯竭程度)
```

| 储量剩余 | 枯竭程度 | 价格影响 |
|----------|----------|----------|
| >90% | 0% | 无影响 |
| 70-90% | +10% | 轻微上涨 |
| 50-70% | +20% | 中等上涨 |
| 30-50% | +40% | 大幅上涨 |
| 10-30% | +80% | 剧烈上涨 |
| <10% | +150% | 极度上涨 |

---

## 市场波动

由市场因素引起的价格波动。

#### 供需波动

```
供需波动 = 基础价格 × (需求/供给)^弹性
```

| 供需比例 | 价格变化 | 波动幅度 |
|----------|----------|----------|
| 0.5 | -41% | 大幅下跌 |
| 0.7 | -21% | 中等下跌 |
| 0.9 | -9% | 轻微下跌 |
| 1.0 | 0% | 无变化 |
| 1.1 | +8% | 轻微上涨 |
| 1.3 | +19% | 中等上涨 |
| 1.5 | +27% | 较大上涨 |
| 2.0 | +41% | 大幅上涨 |

#### 竞争波动

```
竞争波动 = 基础价格 × (1 - 竞争压力)
```

| 竞争者数量 | 竞争压力 | 价格影响 |
|------------|----------|----------|
| 0 | 0% | 无影响 |
| 1-3 | 5-10% | 轻微下降 |
| 4-6 | 10-20% | 中等下降 |
| 7-10 | 20-35% | 较大下降 |
| >10 | 35-50% | 大幅下降 |

#### 技术波动

```
技术波动 = 基础价格 × (1 - 技术进步)
```

| 技术进步程度 | 价格影响 | 时间周期 |
|--------------|----------|----------|
| 小幅进步 | -5% | 30天 |
| 中等进步 | -15% | 60天 |
| 大幅进步 | -30% | 90天 |
| 革命性突破 | -50% | 120天 |

---

## 外部冲击

由外部事件引起的价格波动。

#### 战争冲击

```
战争冲击 = 基础价格 × (1 + 战争强度)
```

| 战争类型 | 战争强度 | 影响商品 | 持续时间 |
|----------|----------|----------|----------|
| 边境冲突 | +10% | 军用品、燃料 | 30天 |
| 局部战争 | +25% | 军用品、粮食 | 60天 |
| 区域战争 | +40% | 军用品、燃料、粮食 | 90天 |
| 全面战争 | +60% | 所有商品 | 180天 |

#### 自然灾害

```
灾害冲击 = 基础价格 × (1 + 灾害强度)
```

| 灾害类型 | 灾害强度 | 影响商品 | 持续时间 |
|----------|----------|----------|----------|
| 地震 | +15% | 建材、工具 | 15-30天 |
| 火山爆发 | +20% | 燃料、建材 | 30-60天 |
| 海啸 | +25% | 食品、建材 | 30-60天 |
| 瘟疫 | +35% | 药品、食品 | 60-90天 |

#### 政策变化

```
政策冲击 = 基础价格 × (1 + 政策影响)
```

| 政策类型 | 政策影响 | 影响商品 | 持续时间 |
|----------|----------|----------|----------|
| 关税上调 | +15% | 进口商品 | 持续 |
| 补贴取消 | +20% | 特定商品 | 持续 |
| 税收增加 | +10% | 所有商品 | 持续 |
| 价格管制 | -30% | 管制商品 | 持续 |

---

## 波动幅度

### 不同商品类型的波动特性

| 商品类型 | 日波动 | 月波动 | 年波动 | 特点 |
|----------|--------|--------|--------|------|
| 原料 | ±1% | ±5% | ±15% | 波动较小 |
| 中间品 | ±1.5% | ±8% | ±20% | 波动中等 |
| 最终品 | ±2% | ±10% | ±25% | 波动较大 |
| 奢侈品 | ±3% | ±15% | ±35% | 波动很大 |
| 军用品 | ±2.5% | ±12% | ±30% | 波动较大 |

### 波动周期

| 波动类型 | 周期长度 | 影响程度 |
|----------|----------|----------|
| 日波动 | 1天 | 小 |
| 周波动 | 7天 | 小中 |
| 月波动 | 30天 | 中 |
| 季节波动 | 90天 | 中大 |
| 年波动 | 365天 | 大 |
| 周期波动 | 3-10年 | 很大 |

---

## 波动机制

### 随机波动

```
随机波动 = 当前价格 × 波动幅度 × 随机系数
```

随机系数：-1 到 1 的随机值。

| 波动幅度 | 每日波动概率 | 波动范围 |
|----------|--------------|----------|
| 低 | 20% | ±0.5% |
| 中 | 40% | ±1.0% |
| 高 | 60% | ±2.0% |

### 趋势波动

```
趋势波动 = 当前价格 × 趋势系数 × 时间
```

| 趋势类型 | 趋势系数 | 周期 |
|----------|----------|------|
| 上升趋势 | +0.1% | 30-60天 |
| 下降趋势 | -0.1% | 30-60天 |
| 稳定趋势 | 0% | 长期 |

### 周期波动

```
周期波动 = 基础价格 × 周期幅度 × sin(时间 / 周期)
```

| 周期类型 | 周期长度 | 周期幅度 |
|----------|----------|----------|
| 季节周期 | 90天 | 10-20% |
| 商业周期 | 365天 | 15-30% |
| 长波周期 | 3-7年 | 30-50% |

---

## 波动影响

### 对生产者的影响

#### 利润影响

```
利润影响 = 价格变化 × 产量 × 利润率
```

| 价格变化 | 利润影响 | 生产者反应 |
|----------|----------|------------|
| 大幅上涨 | 显著增加 | 扩大生产 |
| 中等上涨 | 适度增加 | 维持生产 |
| 基本稳定 | 正常利润 | 正常生产 |
| 中等下跌 | 利润下降 | 减少生产 |
| 大幅下跌 | 严重亏损 | 停止生产 |

#### 产能影响

```
产能调整 = 价格弹性 × 价格变化
```

| 价格变化 | 产能调整 | 时间周期 |
|----------|----------|----------|
| +20% | +15% | 30天 |
| +10% | +8% | 15天 |
| 0% | 0% | 0天 |
| -10% | -8% | 15天 |
| -20% | -15% | 30天 |

### 对消费者的影响

#### 购买力影响

```
购买力变化 = 1 / (1 + 价格变化)
```

| 价格变化 | 购买力 | 消费者反应 |
|----------|--------|------------|
| +20% | 0.83 | 减少消费 |
| +10% | 0.91 | 适度减少 |
| 0% | 1.00 | 正常消费 |
| -10% | 1.11 | 适度增加 |
| -20% | 1.25 | 增加消费 |

#### 需求影响

```
需求变化 = 价格弹性 × 价格变化
```

| 价格变化 | 需求变化 | 时间周期 |
|----------|----------|----------|
| +20% | -10% | 7天 |
| +10% | -5% | 3天 |
| 0% | 0% | 0天 |
| -10% | +5% | 3天 |
| -20% | +10% | 7天 |

### 对经济的影响

#### 通胀影响

```
通胀率 = 平均价格变化 / 初始价格
```

| 通胀率 | 经济状态 | 影响 |
|--------|----------|------|
| <2% | 温和通胀 | 正常 |
| 2-5% | 中度通胀 | 可接受 |
| 5-10% | 高通胀 | 有压力 |
| >10% | 恶性通胀 | 严重问题 |

#### 资源配置影响

```
资源重新配置 = 价格信号 × 时间周期
```

| 价格变化 | 配置效果 | 时间周期 |
|----------|----------|----------|
| 大幅上涨 | 扩大供给 | 30-60天 |
| 中等上涨 | 适度增加 | 15-30天 |
| 基本稳定 | 维持现状 | 持续 |
| 中等下跌 | 适度减少 | 15-30天 |
| 大幅下跌 | 大幅减少 | 30-60天 |

---

## 波动预测

### 短期预测（1-7天）

```
短期预测 = 当前价格 × (1 + 短期趋势)
```

| 预测准确度 | 预测范围 |
|------------|----------|
| 高 | 1-3天 |
| 中 | 4-5天 |
| 低 | 6-7天 |

### 中期预测（1-4周）

```
中期预测 = 当前价格 × (1 + 中期趋势 + 季节因素)
```

| 预测准确度 | 预测范围 |
|------------|----------|
| 中 | 1-2周 |
| 低 | 3-4周 |

### 长期预测（1-12月）

```
长期预测 = 当前价格 × (1 + 长期趋势 + 周期因素)
```

| 预测准确度 | 预测范围 |
|------------|----------|
| 低 | 1-3月 |
| 很低 | 4-12月 |

---

## 波动控制

### 政策控制

#### 价格上限

```
价格上限 = 基础价格 × 上限系数
```

| 上限系数 | 效果 | 副作用 |
|----------|------|--------|
| 0.9 | 稳定价格 | 供给不足 |
| 0.95 | 轻微限制 | 小幅短缺 |
| 1.0 | 无限制 | 正常市场 |

#### 价格下限

```
价格下限 = 基础价格 × 下限系数
```

| 下限系数 | 效果 | 副作用 |
|----------|------|--------|
| 1.1 | 保护生产 | 需求不足 |
| 1.05 | 轻微保护 | 小幅过剩 |
| 1.0 | 无保护 | 正常市场 |

### 市场控制

#### 供需调节

```
调节效果 = 供给增加 + 需求减少
```

| 调节方式 | 效果 | 时间周期 |
|----------|------|----------|
| 增加供给 | 价格下降 | 30-60天 |
| 减少需求 | 价格下降 | 7-14天 |
| 储备释放 | 价格下降 | 立即 |
| 进口增加 | 价格下降 | 15-30天 |

#### 投机控制

```
投机影响 = 投机量 × 波动幅度
```

| 控制方式 | 效果 | 时间周期 |
|----------|------|----------|
| 提高保证金 | 减少投机 | 立即 |
| 限制交易量 | 减少波动 | 立即 |
| 提高税率 | 减少投机 | 立即 |

---

## 波动数据示例

### 典型商品波动数据

| 商品 | 日波动 | 月波动 | 年波动 | 最大波动 |
|------|--------|--------|--------|----------|
| 粮食 | ±1.0% | ±5.0% | ±15% | ±40% |
| 钢材 | ±1.5% | ±8.0% | ±20% | ±50% |
| 服装 | ±2.0% | ±10.0% | ±25% | ±60% |
| 奢侈品 | ±3.0% | ±15.0% | ±35% | ±80% |

### 历史波动事件

| 事件 | 价格变化 | 持续时间 | 恢复时间 |
|------|----------|----------|----------|
| 大丰收 | -30% | 30天 | 60天 |
| 严重干旱 | +50% | 60天 | 120天 |
| 战争爆发 | +60% | 180天 | 365天 |
| 技术突破 | -50% | 120天 | 180天 |

---

## 波动系统接口定义

### 波动管理器接口

```typescript
interface IPriceVolatilityManager {
  calculateVolatility(goodsId: string): number
  predictPrice(goodsId: string, days: number): number

  applyEvent(goodsId: string, event: MarketEvent): void

  setPriceLimit(goodsId: string, minPrice: number, maxPrice: number): void

  getVolatilityHistory(goodsId: string): VolatilityRecord[]
}

interface VolatilityRecord {
  date: number
  price: number
  change: number
  factor: string
}
```

---

## 波动系统性能优化

### 计算优化

1. **批量计算**：多个商品批量计算波动
2. **缓存结果**：缓存波动计算结果
3. **事件驱动**：只在事件触发时重新计算
4. **优先级队列**：重要商品优先处理

### 存储优化

1. **增量存储**：只存储波动变化
2. **定期清理**：清理历史数据
3. **压缩存储**：压缩波动记录
